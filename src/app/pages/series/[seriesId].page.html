<div class="h-24"></div>

@if (series$ | async; as series) {
  <div
    class="flex flex-col items-center overflow-auto pr-4 pl-4 text-white"
    style="height: calc(100vh - 6rem)"
  >
    <div class="flex max-w-screen-lg">
      <div>
        <app-cover-image
          [cover_image]="series.cover_image"
          [name]="series.title"
          size="min-w-40"
        ></app-cover-image>
        <div>
          Creators
          <div class="mt-1 flex flex-col gap-1">
            @for (author of series.authors; track $index) {
              <div class="ml-2 text-sm">
                <span class="text-zinc-200 italic">{{ author.type }}:</span>
                @for (name of author.names; track $index; let count = $count) {
                  <span
                    class="ml-3 text-zinc-400 hover:cursor-pointer hover:font-semibold hover:text-indigo-400"
                    [ngStyle]="count === 1 ? { margin: '0px' } : { display: 'block' }"
                    (click)="openSeriesSearch('author', name)"
                    (keypress)="openSeriesSearch('author', name)"
                    tabindex="{$index}"
                  >
                    {{ name }}
                  </span>
                }
              </div>
            }
          </div>
          Publishers
          <div class="mt-1 flex flex-col gap-1">
            @for (publisher of series.publishers; track $index) {
              <div class="ml-2 text-sm">
                <span class="text-zinc-200 italic">{{ publisher.type }}:</span>
                @for (name of publisher.names; track $index; let count = $count) {
                  <span
                    class="ml-3 text-zinc-400 hover:cursor-pointer hover:font-semibold hover:text-indigo-400"
                    [ngStyle]="count === 1 ? { margin: '0px' } : { display: 'block' }"
                    (click)="openSeriesSearch('publisher', name)"
                    (keypress)="openSeriesSearch('publisher', name)"
                    tabindex="{$index}"
                  >
                    {{ name }}
                  </span>
                }
              </div>
            }
          </div>
          Stats
          <div class="ml-2 text-sm text-zinc-400">
            @for (stat of statLabels; track $index) {
              <p>
                <span class="text-zinc-200 italic">{{ stat.header }}:</span>
                {{ series[stat.field] }}
              </p>
            }
            <p>
              <span class="text-zinc-200 italic">Printed Volumes:</span>
              {{ series.volumes.length }}
            </p>
          </div>
          Publishing Status
          <div class="ml-2 text-sm text-zinc-400">
            @for (status of series.release_status; track $index) {
              <p>{{ status }}</p>
            }
          </div>
        </div>
      </div>
      <div class="ml-4">
        <div class="align-baseline">
          <a class="text-2xl underline" [href]="series.url" target="_blank">
            {{ series.title }}
          </a>
        </div>
        <div class="flex">
          <div class="mt-2 flex flex-col gap-2">
            <div>
              @for (label of headerLabels; track $index) {
                <div class="text-xs text-gray-400 italic">
                  {{ label.header }}:
                  <span class="text-base text-white not-italic">
                    {{ series[label.field] }}
                  </span>
                </div>
              }
            </div>
            <hr class="border-gray-300" />
            <div class="text-wrap">
              <span class="mr-1 text-xs text-gray-400 italic">Description:</span>
              {{ series.description }}
            </div>
            <div class="main-grid m-4 grid grid-cols-5 gap-y-2">
              @for (volume of series.volumes; track $index) {
                <div
                  class="big-shadow col-start-2 col-end-8 grid h-16 w-full cursor-pointer grid-cols-subgrid gap-2 rounded-md bg-zinc-800 pr-4 hover:scale-[1.01] hover:bg-[#37373a]"
                  (click)="openVolumeDetails(volume.isbn)"
                  (keypress)="openVolumeDetails(volume.isbn)"
                  tabindex="{$index}"
                >
                  <app-cover-image
                    [cover_image]="volume.primary_cover_image"
                    [name]="volume.name"
                    size="h-16"
                  ></app-cover-image>
                  <div class="flex w-fit items-center">
                    <p class="tw-2 leading-6">
                      {{ volume.name }}
                    </p>
                  </div>
                  <div class="m-auto w-fit text-center">
                    {{ volume.category.replace('-', ' ') | titlecase }}
                  </div>
                  <div class="m-auto w-fit text-center">Vol {{ volume.volume }}</div>
                  <div class="m-auto w-fit text-center">
                    {{ volume.format }}
                  </div>
                  <div class="m-auto w-fit text-center">
                    {{ volume.release_date | date }}
                  </div>
                </div>
              }
            </div>
          </div>
          <div class="ml-4 flex min-w-40 flex-col gap-4">
            @if (series.genres.length > 0) {
              <div>
                Genres:
                <div class="mt-1 flex flex-col gap-1">
                  @for (genre of series.genres; track $index) {
                    <div
                      class="ml-2 text-sm text-zinc-400 hover:cursor-pointer hover:font-semibold hover:text-indigo-400"
                      (click)="openSeriesSearch('genre', genre)"
                      (keypress)="openSeriesSearch('genre', genre)"
                      tabindex="{$index}"
                    >
                      {{ genre }}
                    </div>
                  }
                </div>
              </div>
            }
            @if (series.themes.length > 0) {
              <div>
                Themes:
                <div class="mt-1 flex flex-col gap-1">
                  @for (theme of series.themes; track $index) {
                    <div
                      class="ml-2 text-sm text-zinc-400 hover:cursor-pointer hover:font-semibold hover:text-indigo-400"
                      (click)="openSeriesSearch('theme', theme.theme)"
                      (keypress)="openSeriesSearch('theme', theme.theme)"
                      tabindex="{$index}"
                    >
                      {{ theme.theme }}
                    </div>
                  }
                </div>
              </div>
            }
          </div>
        </div>
      </div>
    </div>
    @if (series.recommendations.length > 0) {
      <hr class="mt-4 mb-4 max-w-screen-lg border-gray-300" />
      <div class="mt-4 mb-8 flex flex-col gap-2">
        <p>Recommended Series:</p>
        <div class="flex max-w-full flex-wrap gap-4">
          @for (rec of recommendations$ | async; track $index) {
            @defer {
              <div
                class="relative h-40"
                class="relative h-40 cursor-pointer rounded-lg bg-cover bg-center shadow-lg transition-transform duration-300 hover:scale-105"
                style="aspect-ratio: 1 / 1.45"
                [style.background-image]="'url(' + rec.cover_image + ')'"
                (click)="openSeriesDetails(rec.series_id)"
                (keypress)="openSeriesDetails(rec.series_id)"
                tabindex="{$index}"
              >
                <app-volume-cover-text [title]="rec.title" />
              </div>
            } @placeholder {
              <div class="cover-image"></div>
            }
          }
        </div>
      </div>
    }
  </div>
}
